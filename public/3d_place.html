<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>3D collaboration system</title>
        <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>

    </head>
    <body> 

        <input id="inputText" type="text">
        <input id="sendButton" type="submit">
        <ul id="messageList" >
        
        <script src="/socket.io/socket.io.js"></script>
        <script>
            const socket = io();

            const clearText = () =>{
                document.getElementById('inputText').value = '';
            }

            const addMessageList = (message) => {
                const ul = document.getElementById('messageList');
                const li = document.createElement('li');
                const text = document.createTextNode(message);
                li.appendChild(text);
                ul.appendChild(li);
            }

            //送信ボタンのクリックイベント検知
            document.getElementById('sendButton').addEventListener('click', () => {
                 //inputに入力されたテキスト取得
                 let inputMessage = document.getElementById('inputText').value;

                 if (inputMessage === ''){
                    return;
                 }

                 //'sendMessage'イベント発火
                 socket.emit('sendMessage', inputMessage);

                 //input内のテキストを空にする
                 clearText();
            })

            //'receiveMessage'イベントの発火を検知
            //第一引数に受信したメッセージ
            socket.on('receiveMessage', (message) => {
                //受信したメッセージをulタグに挿入
                addMessageList(message);
            });

        </script>

        <!--３D空間の作成-->
        <a-scene >
            <a-box position="0 1 0" rotation="20 40 0" color="red" scale="1 1 1"></a-box>
            <a-camera
                position="0 1 4"
                cursor-visible="true"
                cursor-scale="2"
                cursor-color="blue"
                cursor-opacity="0.5">
            </a-camera>
            <script src="move.js"></script>

            <a-plane position="0 -1 1" rotation="-90 0 0" width="30" height="30" color="silver"></a-plane>
            <!--<a-assets>
                <img id="test1" src="./sample.jpg">
            </a-assets>
            <a-sky src="#test1"></a-sky> -->

             <a-text position="-1 1.25 -3" value="Hello World" color="black"></a-text>

            <a-assets>
                <template id="avatar-template">
                    <a-entitiy class="avatar">
                        <a-sphere class="head" scale="0.45 0.5 0.4"></a-sphere>
                        <a-entitiy class="face" position="0 0.05 0">
                            <a-sphere class="eye" color="black" position="0.16 0.1 -0.35" scale="0.12 0.12 0.12">
                                <a-sphere class="pupil" color="white" position="0 0 -1" scale="0.2 0.2 0.2"></a-sphere>
                            </a-sphere>
                            <a-sphere class="eye" color="black" position="-0.16 0.1 -0.35" scale="0.12 0.12 0.12">
                                <a-sphere class="pupil" color="white" position="0 0 -1" scale="0.2 0.2 0.2"></a-sphere>
                            </a-sphere>
                        </a-entitiy>
                    </a-entitiy>
                </template>
            </a-assets>

        </a-scene>
    </body>
</html>